<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation - example usage • powerHaDeX</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulation - example usage">
<meta property="og:description" content="powerHaDeX">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">powerHaDeX</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Example_simulation.html">Simulation - example usage</a>
    </li>
    <li>
      <a href="../articles/Simulation_description.html">Simulation of HDX data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Example_simulation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simulation - example usage</h1>
            
      
      
      <div class="hidden name"><code>Example_simulation.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">powerHaDeX</span><span class="op">)</span></code></pre></div>
<p>The package <code>powerHaDeX</code> is a tool for simulating and analyzing data coming from HDX-MS experiments along with the possibility of comparing the power of the tests verifying differences in deuteration levels. The functionality of the simulation involves generating a theoretical spectrum along with its replications, replicating the deuterium uptake curves obtained from spectra, and rejection rate estimation for comparison of the tests for differences in deuteration. Let us go through the process of simulation and all its features.</p>
<div id="data-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-simulation" class="anchor"></a>Data simulation</h2>
<div id="theoretical-spectra-simulation" class="section level3">
<h3 class="hasAnchor">
<a href="#theoretical-spectra-simulation" class="anchor"></a>Theoretical spectra simulation</h3>
<p>The first step of the simulation is the generation of theoretical spectra of a deuterated peptide over time. To do so, the function <code>simulate_theoretical_spectra</code> is used. There is the possibility of simulation a mass spectrum for more than one point of time and more than one charge by specifying the parameters <code>charge</code> and <code>times</code>. Providing vector of charges and/or vector of exposure times we obtain a <code>data table</code> of spectra consistent with assumed parameters.</p>
<p>For example, a single spectrum can be simulated as below</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">17</span><span class="op">)</span>

<span class="va">theo_spectrum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_theoretical_spectra.html">simulate_theoretical_spectra</a></span><span class="op">(</span>sequence <span class="op">=</span> <span class="st">"CHERICHERILADY"</span>,
                                              charge <span class="op">=</span> <span class="fl">4</span>,
                                              protection_factor <span class="op">=</span> <span class="fl">100</span>,
                                              times <span class="op">=</span> <span class="fl">0.167</span>,
                                              pH <span class="op">=</span> <span class="fl">7.5</span>,
                                              temperature <span class="op">=</span> <span class="fl">15</span>,
                                              n_molecules <span class="op">=</span> <span class="fl">500</span>,
                                              time_step_const <span class="op">=</span> <span class="fl">1</span>,
                                              use_markov <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">theo_spectrum</span>
<span class="co">#&gt;     Exposure  PH    Intensity       Mz Charge       Sequence  PF</span>
<span class="co">#&gt;  1:    0.000 7.5 0.3519156204 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt;  2:    0.000 7.5 0.3231637738 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt;  3:    0.000 7.5 0.1934355070 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt;  4:    0.000 7.5 0.0868056117 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt;  5:    0.000 7.5 0.0315957363 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt;  6:    0.000 7.5 0.0097206744 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt;  7:    0.000 7.5 0.0025936359 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt;  8:    0.000 7.5 0.0006109695 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt;  9:    0.000 7.5 0.0001288097 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt; 10:    0.167 7.5 0.3209565658 440.2107      4 CHERICHERILADY 100</span>
<span class="co">#&gt; 11:    0.167 7.5 0.3249997450 440.4623      4 CHERICHERILADY 100</span>
<span class="co">#&gt; 12:    0.167 7.5 0.2049151762 440.7138      4 CHERICHERILADY 100</span>
<span class="co">#&gt; 13:    0.167 7.5 0.0964513599 440.9654      4 CHERICHERILADY 100</span>
<span class="co">#&gt; 14:    0.167 7.5 0.0366685527 441.2170      4 CHERICHERILADY 100</span>
<span class="co">#&gt; 15:    0.167 7.5 0.0117564483 441.4686      4 CHERICHERILADY 100</span>
<span class="co">#&gt; 16:    0.167 7.5 0.0032646623 441.7201      4 CHERICHERILADY 100</span>
<span class="co">#&gt; 17:    0.167 7.5 0.0007997219 441.9717      4 CHERICHERILADY 100</span>
<span class="co">#&gt; 18:    0.167 7.5 0.0001752103 442.2233      4 CHERICHERILADY 100</span></code></pre></div>
<p>As we can see in the output - we obtain a spectrum for the given time of measurement 0.167 sec and control measurement measured directly after adding the buffer (conventionally at time equal to 0). Each row of the data is correspondent to a single peak in the spectrum. Such a result for a particular time can be visualized using <code>powerHaDeX</code> as shown below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_spectra.html">plot_spectra</a></span><span class="op">(</span><span class="va">theo_spectrum</span><span class="op">)</span></code></pre></div>
<p><img src="Example_simulation_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can also draw the measurement at the time 0 specifying <code>control_time = TRUE</code> as below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_spectra.html">plot_spectra</a></span><span class="op">(</span><span class="va">theo_spectrum</span>, control_time <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Example_simulation_files/figure-html/unnamed-chunk-4-1.png" width="480" style="display: block; margin: auto;"></p>
<p>As said before, more than one spectrum can be simulated for different exposure times and charges. Such a case is shown in the following code. We specify two values of charge (3 and 5) and time of measurements (0.167 and 5).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">17</span><span class="op">)</span>

<span class="va">theo_spectra</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_theoretical_spectra.html">simulate_theoretical_spectra</a></span><span class="op">(</span>sequence <span class="op">=</span> <span class="st">"CHERICHERILADY"</span>,
                                             charge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,
                                             protection_factor <span class="op">=</span> <span class="fl">100</span>,
                                             times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.167</span>, <span class="fl">5</span><span class="op">)</span>,
                                             pH <span class="op">=</span> <span class="fl">7.5</span>,
                                             temperature <span class="op">=</span> <span class="fl">15</span>,
                                             n_molecules <span class="op">=</span> <span class="fl">500</span>,
                                             time_step_const <span class="op">=</span> <span class="fl">1</span>,
                                             use_markov <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">theo_spectra</span><span class="op">)</span>
<span class="co">#&gt;    Exposure  PH Intensity       Mz Charge       Sequence  PF</span>
<span class="co">#&gt; 1:        0 7.5 0.3519156 586.6118      3 CHERICHERILADY 100</span>
<span class="co">#&gt; 2:        0 7.5 0.3519156 352.3700      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 3:        0 7.5 0.3231638 586.6118      3 CHERICHERILADY 100</span>
<span class="co">#&gt; 4:        0 7.5 0.3231638 352.3700      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 5:        0 7.5 0.1934355 586.6118      3 CHERICHERILADY 100</span>
<span class="co">#&gt; 6:        0 7.5 0.1934355 352.3700      5 CHERICHERILADY 100</span></code></pre></div>
<p>Such a result can be also displayed on the plot as shown below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_spectra.html">plot_spectra</a></span><span class="op">(</span><span class="va">theo_spectra</span><span class="op">)</span></code></pre></div>
<p><img src="Example_simulation_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="replicated-spectra" class="section level3">
<h3 class="hasAnchor">
<a href="#replicated-spectra" class="anchor"></a>Replicated spectra</h3>
<div id="oneall-states" class="section level4">
<h4 class="hasAnchor">
<a href="#oneall-states" class="anchor"></a>one/all states</h4>
<p>To generate replications of the experiment of hydrogen-deuterium exchange the function <code>add_noise_to_spectra</code> can be used. We need to evaluate <code>get_undeuterated_mass</code> and <code>get_spectra_list</code> first as in the code below. By setting <code>compare_pairs = FALSE</code> we do not pair the spectra by protection factors (in the case of our example we did not provide more than one value of protection factor yet).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">undeuterated_mass</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_undeuterated_mass.html">get_undeuterated_mass</a></span><span class="op">(</span><span class="va">theo_spectra</span><span class="op">)</span>
<span class="va">spectra</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_spectra_list.html">get_spectra_list</a></span><span class="op">(</span><span class="va">theo_spectra</span><span class="op">)</span>
<span class="va">replicated_spectra</span> <span class="op">=</span> <span class="fu"><a href="../reference/add_noise_to_spectra.html">add_noise_to_spectra</a></span><span class="op">(</span><span class="va">spectra</span>,
                                          undeuterated_mass <span class="op">=</span> <span class="va">undeuterated_mass</span>,
                                          n_experiments <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">replicated_spectra</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]][[1]]</span>
<span class="co">#&gt;      Exposure  PH    Intensity       Mz Charge       Sequence  PF Rep</span>
<span class="co">#&gt;   1:        0 7.5 0.3519156204 586.4957      3 CHERICHERILADY 100   1</span>
<span class="co">#&gt;   2:        0 7.5 0.3519156204 352.4599      5 CHERICHERILADY 100   1</span>
<span class="co">#&gt;   3:        0 7.5 0.3231637738 586.7029      3 CHERICHERILADY 100   1</span>
<span class="co">#&gt;   4:        0 7.5 0.3231637738 352.2874      5 CHERICHERILADY 100   1</span>
<span class="co">#&gt;   5:        0 7.5 0.1934355070 586.7346      3 CHERICHERILADY 100   1</span>
<span class="co">#&gt;  ---                                                                 </span>
<span class="co">#&gt; 228:        5 7.5 0.0184176796 353.7023      5 CHERICHERILADY 100   4</span>
<span class="co">#&gt; 229:        5 7.5 0.0062067650 353.7496      5 CHERICHERILADY 100   4</span>
<span class="co">#&gt; 230:        5 7.5 0.0018599905 354.1177      5 CHERICHERILADY 100   4</span>
<span class="co">#&gt; 231:        5 7.5 0.0004938085 354.2318      5 CHERICHERILADY 100   4</span>
<span class="co">#&gt; 232:        5 7.5 0.0001104587 354.4601      5 CHERICHERILADY 100   4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[2]]</span>
<span class="co">#&gt;      Exposure  PH    Intensity       Mz Charge       Sequence  PF Rep</span>
<span class="co">#&gt;   1:        0 7.5 0.3519156204 586.5470      3 CHERICHERILADY 100   1</span>
<span class="co">#&gt;   2:        0 7.5 0.3519156204 352.4298      5 CHERICHERILADY 100   1</span>
<span class="co">#&gt;   3:        0 7.5 0.3231637738 586.6087      3 CHERICHERILADY 100   1</span>
<span class="co">#&gt;   4:        0 7.5 0.3231637738 352.3265      5 CHERICHERILADY 100   1</span>
<span class="co">#&gt;   5:        0 7.5 0.1934355070 586.5233      3 CHERICHERILADY 100   1</span>
<span class="co">#&gt;  ---                                                                 </span>
<span class="co">#&gt; 228:        5 7.5 0.0184176796 353.5442      5 CHERICHERILADY 100   4</span>
<span class="co">#&gt; 229:        5 7.5 0.0062067650 353.7953      5 CHERICHERILADY 100   4</span>
<span class="co">#&gt; 230:        5 7.5 0.0018599905 353.9036      5 CHERICHERILADY 100   4</span>
<span class="co">#&gt; 231:        5 7.5 0.0004938085 354.1517      5 CHERICHERILADY 100   4</span>
<span class="co">#&gt; 232:        5 7.5 0.0001104587 354.3799      5 CHERICHERILADY 100   4</span></code></pre></div>
<p>The output of the function <code>add_noise_to_spectra</code> is adapted to the power calculations. Therefore, it is a list of two elements: the first one is correspondent to the pair of protection factors (in the case when <code>compare_pairs = FALSE</code> we consider all protection factors jointly) and the second is correspondent to the repetitions of the whole experiment (used for the needs of power calculations). By setting the number of experiments <code>n_experiments = 2</code> we simulate two experiments, that is (by default) 4 replicates of measurements for given time points, duplicated. The mentioned replicates are defined in the column <code>Rep</code>.</p>
</div>
<div id="paired-states" class="section level4">
<h4 class="hasAnchor">
<a href="#paired-states" class="anchor"></a>paired states</h4>
<p>There is an option of generation noisy spectra such that they are prepared for the pairwise testing procedure (for paired states). To take a look at such an example, let us use <code>theo_spectra</code> generated previously for <code>protection factor = 100</code> and simulate theoretical spectra at state <code>protection factor = 200</code> using the function <code>simulate_theoretical_spectra</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">theo_spectra_pf_100</span> <span class="op">&lt;-</span> <span class="va">theo_spectra</span>
<span class="va">theo_spectra_pf_200</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_theoretical_spectra.html">simulate_theoretical_spectra</a></span><span class="op">(</span>sequence <span class="op">=</span> <span class="st">"CHERICHERILADY"</span>,
                                                    charge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,
                                                    protection_factor <span class="op">=</span> <span class="fl">200</span>,
                                                    times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.167</span>, <span class="fl">5</span><span class="op">)</span>,
                                                    pH <span class="op">=</span> <span class="fl">7.5</span>,
                                                    temperature <span class="op">=</span> <span class="fl">15</span>,
                                                    n_molecules <span class="op">=</span> <span class="fl">500</span>,
                                                    time_step_const <span class="op">=</span> <span class="fl">1</span>,
                                                    use_markov <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">theo_spectra_two_states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">theo_spectra_pf_100</span>, <span class="va">theo_spectra_pf_200</span><span class="op">)</span></code></pre></div>
<p>A data table of spectra at different states (<code>theo_spectra_two_states</code> here) can be used as the argument in the functions responsible for adding noise. As explained before, we use the functions <code>get_undeuterated_mass</code> and <code>get_spectra_list</code> first. We specify the need for the data grouped pairwise in the function <code>get_spectra_list</code> by setting <code>compare_pairs = TRUE</code> and <code>reference = "all"</code> as below</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">undeuterated_mass</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_undeuterated_mass.html">get_undeuterated_mass</a></span><span class="op">(</span><span class="va">theo_spectra_two_states</span><span class="op">)</span>
<span class="va">spectra</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_spectra_list.html">get_spectra_list</a></span><span class="op">(</span><span class="va">theo_spectra_two_states</span>,
                           compare_pairs <span class="op">=</span> <span class="cn">TRUE</span>,
                           reference <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="va">replicated_spectra_paired</span> <span class="op">=</span> <span class="fu"><a href="../reference/add_noise_to_spectra.html">add_noise_to_spectra</a></span><span class="op">(</span><span class="va">spectra</span>,
                                                 undeuterated_mass <span class="op">=</span> <span class="va">undeuterated_mass</span>,
                                                 n_experiments <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">replicated_spectra_paired</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]][[1]]</span>
<span class="co">#&gt;      Exposure  PH    Intensity       Mz Charge       Sequence  PF</span>
<span class="co">#&gt;   1:        0 7.5 0.3519156204 586.7370      3 CHERICHERILADY 100</span>
<span class="co">#&gt;   2:        0 7.5 0.3519156204 352.4086      5 CHERICHERILADY 100</span>
<span class="co">#&gt;   3:        0 7.5 0.3231637738 586.6778      3 CHERICHERILADY 100</span>
<span class="co">#&gt;   4:        0 7.5 0.3231637738 352.3025      5 CHERICHERILADY 100</span>
<span class="co">#&gt;   5:        0 7.5 0.1934355070 586.4973      3 CHERICHERILADY 100</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 452:        5 7.5 0.0352195664 353.2925      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 453:        5 7.5 0.0124630617 353.4778      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 454:        5 7.5 0.0038328707 353.8688      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 455:        5 7.5 0.0010409430 354.1951      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 456:        5 7.5 0.0002418826 354.1752      5 CHERICHERILADY 200</span>
<span class="co">#&gt;      Experimental_state Rep</span>
<span class="co">#&gt;   1:                  A   1</span>
<span class="co">#&gt;   2:                  A   1</span>
<span class="co">#&gt;   3:                  A   1</span>
<span class="co">#&gt;   4:                  A   1</span>
<span class="co">#&gt;   5:                  A   1</span>
<span class="co">#&gt;  ---                       </span>
<span class="co">#&gt; 452:                  B   4</span>
<span class="co">#&gt; 453:                  B   4</span>
<span class="co">#&gt; 454:                  B   4</span>
<span class="co">#&gt; 455:                  B   4</span>
<span class="co">#&gt; 456:                  B   4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[2]]</span>
<span class="co">#&gt;      Exposure  PH    Intensity       Mz Charge       Sequence  PF</span>
<span class="co">#&gt;   1:        0 7.5 0.3519156204 586.4083      3 CHERICHERILADY 100</span>
<span class="co">#&gt;   2:        0 7.5 0.3519156204 352.4195      5 CHERICHERILADY 100</span>
<span class="co">#&gt;   3:        0 7.5 0.3231637738 586.6470      3 CHERICHERILADY 100</span>
<span class="co">#&gt;   4:        0 7.5 0.3231637738 352.4269      5 CHERICHERILADY 100</span>
<span class="co">#&gt;   5:        0 7.5 0.1934355070 586.5192      3 CHERICHERILADY 100</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 452:        5 7.5 0.0352195664 353.4370      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 453:        5 7.5 0.0124630617 353.4969      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 454:        5 7.5 0.0038328707 353.7006      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 455:        5 7.5 0.0010409430 354.0913      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 456:        5 7.5 0.0002418826 354.2725      5 CHERICHERILADY 200</span>
<span class="co">#&gt;      Experimental_state Rep</span>
<span class="co">#&gt;   1:                  A   1</span>
<span class="co">#&gt;   2:                  A   1</span>
<span class="co">#&gt;   3:                  A   1</span>
<span class="co">#&gt;   4:                  A   1</span>
<span class="co">#&gt;   5:                  A   1</span>
<span class="co">#&gt;  ---                       </span>
<span class="co">#&gt; 452:                  B   4</span>
<span class="co">#&gt; 453:                  B   4</span>
<span class="co">#&gt; 454:                  B   4</span>
<span class="co">#&gt; 455:                  B   4</span>
<span class="co">#&gt; 456:                  B   4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [[2]][[1]]</span>
<span class="co">#&gt;      Exposure  PH    Intensity       Mz Charge       Sequence  PF</span>
<span class="co">#&gt;   1:        0 7.5 0.3519156204 586.7216      3 CHERICHERILADY 100</span>
<span class="co">#&gt;   2:        0 7.5 0.3519156204 352.3303      5 CHERICHERILADY 100</span>
<span class="co">#&gt;   3:        0 7.5 0.3231637738 586.5394      3 CHERICHERILADY 100</span>
<span class="co">#&gt;   4:        0 7.5 0.3231637738 352.4421      5 CHERICHERILADY 100</span>
<span class="co">#&gt;   5:        0 7.5 0.1934355070 586.6901      3 CHERICHERILADY 100</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 460:        5 7.5 0.0184176796 353.7459      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 461:        5 7.5 0.0062067650 353.9221      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 462:        5 7.5 0.0018599905 354.0662      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 463:        5 7.5 0.0004938085 354.1538      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 464:        5 7.5 0.0001104587 354.4298      5 CHERICHERILADY 100</span>
<span class="co">#&gt;      Experimental_state Rep</span>
<span class="co">#&gt;   1:                  A   1</span>
<span class="co">#&gt;   2:                  A   1</span>
<span class="co">#&gt;   3:                  A   1</span>
<span class="co">#&gt;   4:                  A   1</span>
<span class="co">#&gt;   5:                  A   1</span>
<span class="co">#&gt;  ---                       </span>
<span class="co">#&gt; 460:                  B   4</span>
<span class="co">#&gt; 461:                  B   4</span>
<span class="co">#&gt; 462:                  B   4</span>
<span class="co">#&gt; 463:                  B   4</span>
<span class="co">#&gt; 464:                  B   4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[2]]</span>
<span class="co">#&gt;      Exposure  PH    Intensity       Mz Charge       Sequence  PF</span>
<span class="co">#&gt;   1:        0 7.5 0.3519156204 586.5392      3 CHERICHERILADY 100</span>
<span class="co">#&gt;   2:        0 7.5 0.3519156204 352.5052      5 CHERICHERILADY 100</span>
<span class="co">#&gt;   3:        0 7.5 0.3231637738 586.5200      3 CHERICHERILADY 100</span>
<span class="co">#&gt;   4:        0 7.5 0.3231637738 352.2501      5 CHERICHERILADY 100</span>
<span class="co">#&gt;   5:        0 7.5 0.1934355070 586.5751      3 CHERICHERILADY 100</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 460:        5 7.5 0.0184176796 353.5050      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 461:        5 7.5 0.0062067650 353.7317      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 462:        5 7.5 0.0018599905 353.9752      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 463:        5 7.5 0.0004938085 354.2930      5 CHERICHERILADY 100</span>
<span class="co">#&gt; 464:        5 7.5 0.0001104587 354.4625      5 CHERICHERILADY 100</span>
<span class="co">#&gt;      Experimental_state Rep</span>
<span class="co">#&gt;   1:                  A   1</span>
<span class="co">#&gt;   2:                  A   1</span>
<span class="co">#&gt;   3:                  A   1</span>
<span class="co">#&gt;   4:                  A   1</span>
<span class="co">#&gt;   5:                  A   1</span>
<span class="co">#&gt;  ---                       </span>
<span class="co">#&gt; 460:                  B   4</span>
<span class="co">#&gt; 461:                  B   4</span>
<span class="co">#&gt; 462:                  B   4</span>
<span class="co">#&gt; 463:                  B   4</span>
<span class="co">#&gt; 464:                  B   4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [[3]][[1]]</span>
<span class="co">#&gt;      Exposure  PH    Intensity       Mz Charge       Sequence  PF</span>
<span class="co">#&gt;   1:        0 7.5 0.3519156204 586.5642      3 CHERICHERILADY 200</span>
<span class="co">#&gt;   2:        0 7.5 0.3519156204 352.2645      5 CHERICHERILADY 200</span>
<span class="co">#&gt;   3:        0 7.5 0.3231637738 586.6306      3 CHERICHERILADY 200</span>
<span class="co">#&gt;   4:        0 7.5 0.3231637738 352.4414      5 CHERICHERILADY 200</span>
<span class="co">#&gt;   5:        0 7.5 0.1934355070 586.6002      3 CHERICHERILADY 200</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 444:        5 7.5 0.0352195664 353.3482      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 445:        5 7.5 0.0124630617 353.4801      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 446:        5 7.5 0.0038328707 353.7377      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 447:        5 7.5 0.0010409430 354.0588      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 448:        5 7.5 0.0002418826 354.2376      5 CHERICHERILADY 200</span>
<span class="co">#&gt;      Experimental_state Rep</span>
<span class="co">#&gt;   1:                  A   1</span>
<span class="co">#&gt;   2:                  A   1</span>
<span class="co">#&gt;   3:                  A   1</span>
<span class="co">#&gt;   4:                  A   1</span>
<span class="co">#&gt;   5:                  A   1</span>
<span class="co">#&gt;  ---                       </span>
<span class="co">#&gt; 444:                  B   4</span>
<span class="co">#&gt; 445:                  B   4</span>
<span class="co">#&gt; 446:                  B   4</span>
<span class="co">#&gt; 447:                  B   4</span>
<span class="co">#&gt; 448:                  B   4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]][[2]]</span>
<span class="co">#&gt;      Exposure  PH    Intensity       Mz Charge       Sequence  PF</span>
<span class="co">#&gt;   1:        0 7.5 0.3519156204 586.6821      3 CHERICHERILADY 200</span>
<span class="co">#&gt;   2:        0 7.5 0.3519156204 352.5324      5 CHERICHERILADY 200</span>
<span class="co">#&gt;   3:        0 7.5 0.3231637738 586.6122      3 CHERICHERILADY 200</span>
<span class="co">#&gt;   4:        0 7.5 0.3231637738 352.3069      5 CHERICHERILADY 200</span>
<span class="co">#&gt;   5:        0 7.5 0.1934355070 586.7892      3 CHERICHERILADY 200</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 444:        5 7.5 0.0352195664 353.2613      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 445:        5 7.5 0.0124630617 353.5934      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 446:        5 7.5 0.0038328707 353.8038      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 447:        5 7.5 0.0010409430 353.9717      5 CHERICHERILADY 200</span>
<span class="co">#&gt; 448:        5 7.5 0.0002418826 354.1598      5 CHERICHERILADY 200</span>
<span class="co">#&gt;      Experimental_state Rep</span>
<span class="co">#&gt;   1:                  A   1</span>
<span class="co">#&gt;   2:                  A   1</span>
<span class="co">#&gt;   3:                  A   1</span>
<span class="co">#&gt;   4:                  A   1</span>
<span class="co">#&gt;   5:                  A   1</span>
<span class="co">#&gt;  ---                       </span>
<span class="co">#&gt; 444:                  B   4</span>
<span class="co">#&gt; 445:                  B   4</span>
<span class="co">#&gt; 446:                  B   4</span>
<span class="co">#&gt; 447:                  B   4</span>
<span class="co">#&gt; 448:                  B   4</span></code></pre></div>
<p>As we can see, we obtained the output adapted to the pairwise comparison - each element of a list is a list of data tables (according to the argument <code>n_experiments</code>) for paired states. In our example, we get three pairs: 100 vs. 200 for power estimation and 100 vs. 100, 200 vs, 200 for type I error estimation.</p>
</div>
<div id="deuteration-curves-from-spectra" class="section level4">
<h4 class="hasAnchor">
<a href="#deuteration-curves-from-spectra" class="anchor"></a>deuteration curves from spectra</h4>
<p>Having noisy mass spectra simulated by the function <code>add_noise_to_spectra</code> as shown in the previous sections we can use the function <code>get_deuteration_curves_from_spectra</code> to calculate deuterium uptake as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deuteration_curves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_deuteration_curves_from_spectra.html">get_deuteration_curves_from_spectra</a></span><span class="op">(</span><span class="va">replicated_spectra</span><span class="op">)</span>
<span class="va">deuteration_curves</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]][[1]]</span>
<span class="co">#&gt;     Exposure  PH Charge       Sequence  PF Rep     Mass</span>
<span class="co">#&gt;  1:    0.000 7.5      3 CHERICHERILADY 100   1 1756.877</span>
<span class="co">#&gt;  2:    0.000 7.5      5 CHERICHERILADY 100   1 1757.043</span>
<span class="co">#&gt;  3:    0.000 7.5      3 CHERICHERILADY 100   2 1756.888</span>
<span class="co">#&gt;  4:    0.000 7.5      5 CHERICHERILADY 100   2 1756.976</span>
<span class="co">#&gt;  5:    0.000 7.5      3 CHERICHERILADY 100   3 1756.869</span>
<span class="co">#&gt;  6:    0.000 7.5      5 CHERICHERILADY 100   3 1756.964</span>
<span class="co">#&gt;  7:    0.000 7.5      3 CHERICHERILADY 100   4 1756.732</span>
<span class="co">#&gt;  8:    0.000 7.5      5 CHERICHERILADY 100   4 1756.731</span>
<span class="co">#&gt;  9:    0.167 7.5      3 CHERICHERILADY 100   1 1758.086</span>
<span class="co">#&gt; 10:    0.167 7.5      5 CHERICHERILADY 100   1 1758.149</span>
<span class="co">#&gt; 11:    0.167 7.5      3 CHERICHERILADY 100   2 1758.032</span>
<span class="co">#&gt; 12:    0.167 7.5      5 CHERICHERILADY 100   2 1758.247</span>
<span class="co">#&gt; 13:    0.167 7.5      3 CHERICHERILADY 100   3 1757.928</span>
<span class="co">#&gt; 14:    0.167 7.5      5 CHERICHERILADY 100   3 1758.456</span>
<span class="co">#&gt; 15:    0.167 7.5      3 CHERICHERILADY 100   4 1757.913</span>
<span class="co">#&gt; 16:    0.167 7.5      5 CHERICHERILADY 100   4 1758.034</span>
<span class="co">#&gt; 17:    5.000 7.5      3 CHERICHERILADY 100   1 1758.950</span>
<span class="co">#&gt; 18:    5.000 7.5      5 CHERICHERILADY 100   1 1759.048</span>
<span class="co">#&gt; 19:    5.000 7.5      3 CHERICHERILADY 100   2 1759.271</span>
<span class="co">#&gt; 20:    5.000 7.5      5 CHERICHERILADY 100   2 1758.711</span>
<span class="co">#&gt; 21:    5.000 7.5      3 CHERICHERILADY 100   3 1758.791</span>
<span class="co">#&gt; 22:    5.000 7.5      5 CHERICHERILADY 100   3 1758.703</span>
<span class="co">#&gt; 23:    5.000 7.5      3 CHERICHERILADY 100   4 1759.277</span>
<span class="co">#&gt; 24:    5.000 7.5      5 CHERICHERILADY 100   4 1759.155</span>
<span class="co">#&gt;     Exposure  PH Charge       Sequence  PF Rep     Mass</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[2]]</span>
<span class="co">#&gt;     Exposure  PH Charge       Sequence  PF Rep     Mass</span>
<span class="co">#&gt;  1:    0.000 7.5      3 CHERICHERILADY 100   1 1756.698</span>
<span class="co">#&gt;  2:    0.000 7.5      5 CHERICHERILADY 100   1 1756.690</span>
<span class="co">#&gt;  3:    0.000 7.5      3 CHERICHERILADY 100   2 1756.934</span>
<span class="co">#&gt;  4:    0.000 7.5      5 CHERICHERILADY 100   2 1756.727</span>
<span class="co">#&gt;  5:    0.000 7.5      3 CHERICHERILADY 100   3 1756.560</span>
<span class="co">#&gt;  6:    0.000 7.5      5 CHERICHERILADY 100   3 1757.230</span>
<span class="co">#&gt;  7:    0.000 7.5      3 CHERICHERILADY 100   4 1756.910</span>
<span class="co">#&gt;  8:    0.000 7.5      5 CHERICHERILADY 100   4 1756.577</span>
<span class="co">#&gt;  9:    0.167 7.5      3 CHERICHERILADY 100   1 1757.889</span>
<span class="co">#&gt; 10:    0.167 7.5      5 CHERICHERILADY 100   1 1758.118</span>
<span class="co">#&gt; 11:    0.167 7.5      3 CHERICHERILADY 100   2 1758.136</span>
<span class="co">#&gt; 12:    0.167 7.5      5 CHERICHERILADY 100   2 1758.097</span>
<span class="co">#&gt; 13:    0.167 7.5      3 CHERICHERILADY 100   3 1757.922</span>
<span class="co">#&gt; 14:    0.167 7.5      5 CHERICHERILADY 100   3 1758.285</span>
<span class="co">#&gt; 15:    0.167 7.5      3 CHERICHERILADY 100   4 1757.953</span>
<span class="co">#&gt; 16:    0.167 7.5      5 CHERICHERILADY 100   4 1758.229</span>
<span class="co">#&gt; 17:    5.000 7.5      3 CHERICHERILADY 100   1 1758.956</span>
<span class="co">#&gt; 18:    5.000 7.5      5 CHERICHERILADY 100   1 1758.982</span>
<span class="co">#&gt; 19:    5.000 7.5      3 CHERICHERILADY 100   2 1759.049</span>
<span class="co">#&gt; 20:    5.000 7.5      5 CHERICHERILADY 100   2 1758.665</span>
<span class="co">#&gt; 21:    5.000 7.5      3 CHERICHERILADY 100   3 1759.001</span>
<span class="co">#&gt; 22:    5.000 7.5      5 CHERICHERILADY 100   3 1759.295</span>
<span class="co">#&gt; 23:    5.000 7.5      3 CHERICHERILADY 100   4 1758.946</span>
<span class="co">#&gt; 24:    5.000 7.5      5 CHERICHERILADY 100   4 1758.728</span>
<span class="co">#&gt;     Exposure  PH Charge       Sequence  PF Rep     Mass</span></code></pre></div>
<p>As we can see, we obtain the output analogous to the output of <code>add_noise_to_spectra</code> but containing deuterium uptake curves instead of mass spectra.</p>
</div>
</div>
</div>
<div id="noisy-deuteration-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#noisy-deuteration-curves" class="anchor"></a>Noisy deuteration curves</h2>
<p>We can also simulate noisy deuteration curves using the direct output of <code>simulate_theoretical_spectra</code>. As mentioned before, we specify the number of technical replicates and executions of the experiment using the arguments <code>n_replicates</code> and <code>n_experiments</code>. An example for the case when one/“all” states are considered is shown in the following code:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_noisy_deuteration_curves.html">get_noisy_deuteration_curves</a></span><span class="op">(</span><span class="va">theo_spectra</span>,
                             n_replicates <span class="op">=</span> <span class="fl">4</span>,
                             n_experiments <span class="op">=</span> <span class="fl">2</span>,
                             compare_pairs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]][[1]]</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge</span>
<span class="co">#&gt;  1: CHERICHERILADY   1   100    0.000 0.0000000      3</span>
<span class="co">#&gt;  2: CHERICHERILADY   1   100    0.000 0.0000000      5</span>
<span class="co">#&gt;  3: CHERICHERILADY   1   100    0.167 1.0217790      3</span>
<span class="co">#&gt;  4: CHERICHERILADY   1   100    0.167 1.1115481      5</span>
<span class="co">#&gt;  5: CHERICHERILADY   1   100    5.000 2.2000449      3</span>
<span class="co">#&gt;  6: CHERICHERILADY   1   100    5.000 2.4815535      5</span>
<span class="co">#&gt;  7: CHERICHERILADY   2   100    0.000 0.0000000      3</span>
<span class="co">#&gt;  8: CHERICHERILADY   2   100    0.000 0.0000000      5</span>
<span class="co">#&gt;  9: CHERICHERILADY   2   100    0.167 0.9464547      3</span>
<span class="co">#&gt; 10: CHERICHERILADY   2   100    0.167 0.8102006      5</span>
<span class="co">#&gt; 11: CHERICHERILADY   2   100    5.000 2.1403363      3</span>
<span class="co">#&gt; 12: CHERICHERILADY   2   100    5.000 1.8741435      5</span>
<span class="co">#&gt; 13: CHERICHERILADY   3   100    0.000 0.0000000      3</span>
<span class="co">#&gt; 14: CHERICHERILADY   3   100    0.000 0.0000000      5</span>
<span class="co">#&gt; 15: CHERICHERILADY   3   100    0.167 1.0501886      3</span>
<span class="co">#&gt; 16: CHERICHERILADY   3   100    0.167 1.5787876      5</span>
<span class="co">#&gt; 17: CHERICHERILADY   3   100    5.000 2.0908309      3</span>
<span class="co">#&gt; 18: CHERICHERILADY   3   100    5.000 2.1018103      5</span>
<span class="co">#&gt; 19: CHERICHERILADY   4   100    0.000 0.0000000      3</span>
<span class="co">#&gt; 20: CHERICHERILADY   4   100    0.000 0.0000000      5</span>
<span class="co">#&gt; 21: CHERICHERILADY   4   100    0.167 1.4237105      3</span>
<span class="co">#&gt; 22: CHERICHERILADY   4   100    0.167 0.8013307      5</span>
<span class="co">#&gt; 23: CHERICHERILADY   4   100    5.000 2.0033885      3</span>
<span class="co">#&gt; 24: CHERICHERILADY   4   100    5.000 2.5667487      5</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[2]]</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge</span>
<span class="co">#&gt;  1: CHERICHERILADY   1   100    0.000 0.0000000      3</span>
<span class="co">#&gt;  2: CHERICHERILADY   1   100    0.000 0.0000000      5</span>
<span class="co">#&gt;  3: CHERICHERILADY   1   100    0.167 1.2843118      3</span>
<span class="co">#&gt;  4: CHERICHERILADY   1   100    0.167 1.2523143      5</span>
<span class="co">#&gt;  5: CHERICHERILADY   1   100    5.000 2.2997912      3</span>
<span class="co">#&gt;  6: CHERICHERILADY   1   100    5.000 2.4740207      5</span>
<span class="co">#&gt;  7: CHERICHERILADY   2   100    0.000 0.0000000      3</span>
<span class="co">#&gt;  8: CHERICHERILADY   2   100    0.000 0.0000000      5</span>
<span class="co">#&gt;  9: CHERICHERILADY   2   100    0.167 1.2818168      3</span>
<span class="co">#&gt; 10: CHERICHERILADY   2   100    0.167 1.2974389      5</span>
<span class="co">#&gt; 11: CHERICHERILADY   2   100    5.000 1.8699221      3</span>
<span class="co">#&gt; 12: CHERICHERILADY   2   100    5.000 2.6689255      5</span>
<span class="co">#&gt; 13: CHERICHERILADY   3   100    0.000 0.0000000      3</span>
<span class="co">#&gt; 14: CHERICHERILADY   3   100    0.000 0.0000000      5</span>
<span class="co">#&gt; 15: CHERICHERILADY   3   100    0.167 0.7400186      3</span>
<span class="co">#&gt; 16: CHERICHERILADY   3   100    0.167 0.4871051      5</span>
<span class="co">#&gt; 17: CHERICHERILADY   3   100    5.000 1.7770345      3</span>
<span class="co">#&gt; 18: CHERICHERILADY   3   100    5.000 1.9142936      5</span>
<span class="co">#&gt; 19: CHERICHERILADY   4   100    0.000 0.0000000      3</span>
<span class="co">#&gt; 20: CHERICHERILADY   4   100    0.000 0.0000000      5</span>
<span class="co">#&gt; 21: CHERICHERILADY   4   100    0.167 1.5793063      3</span>
<span class="co">#&gt; 22: CHERICHERILADY   4   100    0.167 1.4803818      5</span>
<span class="co">#&gt; 23: CHERICHERILADY   4   100    5.000 2.2572368      3</span>
<span class="co">#&gt; 24: CHERICHERILADY   4   100    5.000 2.0599348      5</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge</span></code></pre></div>
<p>The case when the pairwise comparisons are considered requires providing the data simulated for different protection factors. Let us take a look at the results for <code>theo_spectra_two_states</code> simulated in the previous section:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deuteration_curves_paired_states</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_noisy_deuteration_curves.html">get_noisy_deuteration_curves</a></span><span class="op">(</span><span class="va">theo_spectra_two_states</span>,
                                                                 n_replicates <span class="op">=</span> <span class="fl">4</span>,
                                                                 n_experiments <span class="op">=</span> <span class="fl">2</span>,
                                                                 compare_pairs <span class="op">=</span> <span class="cn">TRUE</span>,
                                                                 reference <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="va">deuteration_curves_paired_states</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]][[1]]</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt;  1: CHERICHERILADY   1   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt;  2: CHERICHERILADY   1   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt;  3: CHERICHERILADY   1   100    0.167 1.5207689      3                  A</span>
<span class="co">#&gt;  4: CHERICHERILADY   1   100    0.167 0.7352172      5                  A</span>
<span class="co">#&gt;  5: CHERICHERILADY   1   100    5.000 2.1869179      3                  A</span>
<span class="co">#&gt;  6: CHERICHERILADY   1   100    5.000 1.8464555      5                  A</span>
<span class="co">#&gt;  7: CHERICHERILADY   1   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt;  8: CHERICHERILADY   1   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt;  9: CHERICHERILADY   1   200    0.167 1.2827260      3                  B</span>
<span class="co">#&gt; 10: CHERICHERILADY   1   200    0.167 1.0469703      5                  B</span>
<span class="co">#&gt; 11: CHERICHERILADY   1   200    5.000 1.7941624      3                  B</span>
<span class="co">#&gt; 12: CHERICHERILADY   1   200    5.000 1.7559851      5                  B</span>
<span class="co">#&gt; 13: CHERICHERILADY   2   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 14: CHERICHERILADY   2   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 15: CHERICHERILADY   2   100    0.167 1.0475764      3                  A</span>
<span class="co">#&gt; 16: CHERICHERILADY   2   100    0.167 1.9204614      5                  A</span>
<span class="co">#&gt; 17: CHERICHERILADY   2   100    5.000 1.9722249      3                  A</span>
<span class="co">#&gt; 18: CHERICHERILADY   2   100    5.000 2.6312181      5                  A</span>
<span class="co">#&gt; 19: CHERICHERILADY   2   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 20: CHERICHERILADY   2   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 21: CHERICHERILADY   2   200    0.167 1.4472922      3                  B</span>
<span class="co">#&gt; 22: CHERICHERILADY   2   200    0.167 1.1995781      5                  B</span>
<span class="co">#&gt; 23: CHERICHERILADY   2   200    5.000 1.9419813      3                  B</span>
<span class="co">#&gt; 24: CHERICHERILADY   2   200    5.000 2.0305247      5                  B</span>
<span class="co">#&gt; 25: CHERICHERILADY   3   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 26: CHERICHERILADY   3   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 27: CHERICHERILADY   3   100    0.167 1.0726453      3                  A</span>
<span class="co">#&gt; 28: CHERICHERILADY   3   100    0.167 1.2602940      5                  A</span>
<span class="co">#&gt; 29: CHERICHERILADY   3   100    5.000 2.3765079      3                  A</span>
<span class="co">#&gt; 30: CHERICHERILADY   3   100    5.000 1.9773408      5                  A</span>
<span class="co">#&gt; 31: CHERICHERILADY   3   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 32: CHERICHERILADY   3   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 33: CHERICHERILADY   3   200    0.167 1.0148760      3                  B</span>
<span class="co">#&gt; 34: CHERICHERILADY   3   200    0.167 1.8425044      5                  B</span>
<span class="co">#&gt; 35: CHERICHERILADY   3   200    5.000 1.8452257      3                  B</span>
<span class="co">#&gt; 36: CHERICHERILADY   3   200    5.000 1.9145016      5                  B</span>
<span class="co">#&gt; 37: CHERICHERILADY   4   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 38: CHERICHERILADY   4   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 39: CHERICHERILADY   4   100    0.167 1.4018812      3                  A</span>
<span class="co">#&gt; 40: CHERICHERILADY   4   100    0.167 1.4990865      5                  A</span>
<span class="co">#&gt; 41: CHERICHERILADY   4   100    5.000 2.1589545      3                  A</span>
<span class="co">#&gt; 42: CHERICHERILADY   4   100    5.000 2.0232537      5                  A</span>
<span class="co">#&gt; 43: CHERICHERILADY   4   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 44: CHERICHERILADY   4   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 45: CHERICHERILADY   4   200    0.167 0.9609064      3                  B</span>
<span class="co">#&gt; 46: CHERICHERILADY   4   200    0.167 1.1868611      5                  B</span>
<span class="co">#&gt; 47: CHERICHERILADY   4   200    5.000 1.8657509      3                  B</span>
<span class="co">#&gt; 48: CHERICHERILADY   4   200    5.000 2.0116651      5                  B</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[2]]</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt;  1: CHERICHERILADY   1   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt;  2: CHERICHERILADY   1   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt;  3: CHERICHERILADY   1   100    0.167 1.6781217      3                  A</span>
<span class="co">#&gt;  4: CHERICHERILADY   1   100    0.167 0.4808957      5                  A</span>
<span class="co">#&gt;  5: CHERICHERILADY   1   100    5.000 2.6580429      3                  A</span>
<span class="co">#&gt;  6: CHERICHERILADY   1   100    5.000 1.9883399      5                  A</span>
<span class="co">#&gt;  7: CHERICHERILADY   1   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt;  8: CHERICHERILADY   1   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt;  9: CHERICHERILADY   1   200    0.167 1.3999345      3                  B</span>
<span class="co">#&gt; 10: CHERICHERILADY   1   200    0.167 1.1900220      5                  B</span>
<span class="co">#&gt; 11: CHERICHERILADY   1   200    5.000 2.1148292      3                  B</span>
<span class="co">#&gt; 12: CHERICHERILADY   1   200    5.000 1.7987158      5                  B</span>
<span class="co">#&gt; 13: CHERICHERILADY   2   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 14: CHERICHERILADY   2   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 15: CHERICHERILADY   2   100    0.167 1.3323371      3                  A</span>
<span class="co">#&gt; 16: CHERICHERILADY   2   100    0.167 1.3423614      5                  A</span>
<span class="co">#&gt; 17: CHERICHERILADY   2   100    5.000 2.4359630      3                  A</span>
<span class="co">#&gt; 18: CHERICHERILADY   2   100    5.000 2.5127416      5                  A</span>
<span class="co">#&gt; 19: CHERICHERILADY   2   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 20: CHERICHERILADY   2   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 21: CHERICHERILADY   2   200    0.167 1.1928251      3                  B</span>
<span class="co">#&gt; 22: CHERICHERILADY   2   200    0.167 1.1177404      5                  B</span>
<span class="co">#&gt; 23: CHERICHERILADY   2   200    5.000 1.9404736      3                  B</span>
<span class="co">#&gt; 24: CHERICHERILADY   2   200    5.000 1.7554388      5                  B</span>
<span class="co">#&gt; 25: CHERICHERILADY   3   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 26: CHERICHERILADY   3   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 27: CHERICHERILADY   3   100    0.167 1.1646453      3                  A</span>
<span class="co">#&gt; 28: CHERICHERILADY   3   100    0.167 1.0842386      5                  A</span>
<span class="co">#&gt; 29: CHERICHERILADY   3   100    5.000 2.0189018      3                  A</span>
<span class="co">#&gt; 30: CHERICHERILADY   3   100    5.000 1.8269066      5                  A</span>
<span class="co">#&gt; 31: CHERICHERILADY   3   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 32: CHERICHERILADY   3   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 33: CHERICHERILADY   3   200    0.167 1.0505442      3                  B</span>
<span class="co">#&gt; 34: CHERICHERILADY   3   200    0.167 1.0031656      5                  B</span>
<span class="co">#&gt; 35: CHERICHERILADY   3   200    5.000 1.9077371      3                  B</span>
<span class="co">#&gt; 36: CHERICHERILADY   3   200    5.000 1.9325159      5                  B</span>
<span class="co">#&gt; 37: CHERICHERILADY   4   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 38: CHERICHERILADY   4   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 39: CHERICHERILADY   4   100    0.167 1.1083388      3                  A</span>
<span class="co">#&gt; 40: CHERICHERILADY   4   100    0.167 0.9574459      5                  A</span>
<span class="co">#&gt; 41: CHERICHERILADY   4   100    5.000 1.7538790      3                  A</span>
<span class="co">#&gt; 42: CHERICHERILADY   4   100    5.000 2.3883536      5                  A</span>
<span class="co">#&gt; 43: CHERICHERILADY   4   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 44: CHERICHERILADY   4   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 45: CHERICHERILADY   4   200    0.167 1.1834793      3                  B</span>
<span class="co">#&gt; 46: CHERICHERILADY   4   200    0.167 1.2435665      5                  B</span>
<span class="co">#&gt; 47: CHERICHERILADY   4   200    5.000 2.0890209      3                  B</span>
<span class="co">#&gt; 48: CHERICHERILADY   4   200    5.000 1.7799847      5                  B</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [[2]][[1]]</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt;  1: CHERICHERILADY   1   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt;  2: CHERICHERILADY   1   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt;  3: CHERICHERILADY   1   100    0.167 1.3770517      3                  A</span>
<span class="co">#&gt;  4: CHERICHERILADY   1   100    0.167 1.0946753      5                  A</span>
<span class="co">#&gt;  5: CHERICHERILADY   1   100    5.000 2.2676963      3                  A</span>
<span class="co">#&gt;  6: CHERICHERILADY   1   100    5.000 2.1869644      5                  A</span>
<span class="co">#&gt;  7: CHERICHERILADY   1   100    0.000 0.0000000      3                  B</span>
<span class="co">#&gt;  8: CHERICHERILADY   1   100    0.000 0.0000000      5                  B</span>
<span class="co">#&gt;  9: CHERICHERILADY   1   100    0.167 1.4280720      3                  B</span>
<span class="co">#&gt; 10: CHERICHERILADY   1   100    0.167 0.6347083      5                  B</span>
<span class="co">#&gt; 11: CHERICHERILADY   1   100    5.000 2.2459142      3                  B</span>
<span class="co">#&gt; 12: CHERICHERILADY   1   100    5.000 1.7591879      5                  B</span>
<span class="co">#&gt; 13: CHERICHERILADY   2   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 14: CHERICHERILADY   2   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 15: CHERICHERILADY   2   100    0.167 0.8076238      3                  A</span>
<span class="co">#&gt; 16: CHERICHERILADY   2   100    0.167 0.4181348      5                  A</span>
<span class="co">#&gt; 17: CHERICHERILADY   2   100    5.000 1.9222855      3                  A</span>
<span class="co">#&gt; 18: CHERICHERILADY   2   100    5.000 2.0144909      5                  A</span>
<span class="co">#&gt; 19: CHERICHERILADY   2   100    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 20: CHERICHERILADY   2   100    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 21: CHERICHERILADY   2   100    0.167 1.3234358      3                  B</span>
<span class="co">#&gt; 22: CHERICHERILADY   2   100    0.167 1.0481475      5                  B</span>
<span class="co">#&gt; 23: CHERICHERILADY   2   100    5.000 2.1908907      3                  B</span>
<span class="co">#&gt; 24: CHERICHERILADY   2   100    5.000 2.3685638      5                  B</span>
<span class="co">#&gt; 25: CHERICHERILADY   3   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 26: CHERICHERILADY   3   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 27: CHERICHERILADY   3   100    0.167 0.9039832      3                  A</span>
<span class="co">#&gt; 28: CHERICHERILADY   3   100    0.167 1.0006418      5                  A</span>
<span class="co">#&gt; 29: CHERICHERILADY   3   100    5.000 1.7835761      3                  A</span>
<span class="co">#&gt; 30: CHERICHERILADY   3   100    5.000 1.7206495      5                  A</span>
<span class="co">#&gt; 31: CHERICHERILADY   3   100    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 32: CHERICHERILADY   3   100    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 33: CHERICHERILADY   3   100    0.167 1.4370787      3                  B</span>
<span class="co">#&gt; 34: CHERICHERILADY   3   100    0.167 0.9982968      5                  B</span>
<span class="co">#&gt; 35: CHERICHERILADY   3   100    5.000 1.8583631      3                  B</span>
<span class="co">#&gt; 36: CHERICHERILADY   3   100    5.000 2.1806191      5                  B</span>
<span class="co">#&gt; 37: CHERICHERILADY   4   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 38: CHERICHERILADY   4   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 39: CHERICHERILADY   4   100    0.167 1.4723786      3                  A</span>
<span class="co">#&gt; 40: CHERICHERILADY   4   100    0.167 0.9099599      5                  A</span>
<span class="co">#&gt; 41: CHERICHERILADY   4   100    5.000 2.2107337      3                  A</span>
<span class="co">#&gt; 42: CHERICHERILADY   4   100    5.000 1.6726933      5                  A</span>
<span class="co">#&gt; 43: CHERICHERILADY   4   100    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 44: CHERICHERILADY   4   100    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 45: CHERICHERILADY   4   100    0.167 1.5922112      3                  B</span>
<span class="co">#&gt; 46: CHERICHERILADY   4   100    0.167 1.0559666      5                  B</span>
<span class="co">#&gt; 47: CHERICHERILADY   4   100    5.000 2.8185554      3                  B</span>
<span class="co">#&gt; 48: CHERICHERILADY   4   100    5.000 2.2032581      5                  B</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[2]]</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt;  1: CHERICHERILADY   1   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt;  2: CHERICHERILADY   1   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt;  3: CHERICHERILADY   1   100    0.167 1.1539172      3                  A</span>
<span class="co">#&gt;  4: CHERICHERILADY   1   100    0.167 1.5709964      5                  A</span>
<span class="co">#&gt;  5: CHERICHERILADY   1   100    5.000 2.1800052      3                  A</span>
<span class="co">#&gt;  6: CHERICHERILADY   1   100    5.000 2.8243194      5                  A</span>
<span class="co">#&gt;  7: CHERICHERILADY   1   100    0.000 0.0000000      3                  B</span>
<span class="co">#&gt;  8: CHERICHERILADY   1   100    0.000 0.0000000      5                  B</span>
<span class="co">#&gt;  9: CHERICHERILADY   1   100    0.167 1.1454261      3                  B</span>
<span class="co">#&gt; 10: CHERICHERILADY   1   100    0.167 0.9793045      5                  B</span>
<span class="co">#&gt; 11: CHERICHERILADY   1   100    5.000 2.2666683      3                  B</span>
<span class="co">#&gt; 12: CHERICHERILADY   1   100    5.000 2.3877039      5                  B</span>
<span class="co">#&gt; 13: CHERICHERILADY   2   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 14: CHERICHERILADY   2   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 15: CHERICHERILADY   2   100    0.167 1.3112611      3                  A</span>
<span class="co">#&gt; 16: CHERICHERILADY   2   100    0.167 1.4761010      5                  A</span>
<span class="co">#&gt; 17: CHERICHERILADY   2   100    5.000 2.3261447      3                  A</span>
<span class="co">#&gt; 18: CHERICHERILADY   2   100    5.000 2.5973632      5                  A</span>
<span class="co">#&gt; 19: CHERICHERILADY   2   100    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 20: CHERICHERILADY   2   100    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 21: CHERICHERILADY   2   100    0.167 1.2893253      3                  B</span>
<span class="co">#&gt; 22: CHERICHERILADY   2   100    0.167 1.0561114      5                  B</span>
<span class="co">#&gt; 23: CHERICHERILADY   2   100    5.000 2.4315334      3                  B</span>
<span class="co">#&gt; 24: CHERICHERILADY   2   100    5.000 2.2832633      5                  B</span>
<span class="co">#&gt; 25: CHERICHERILADY   3   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 26: CHERICHERILADY   3   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 27: CHERICHERILADY   3   100    0.167 1.0852956      3                  A</span>
<span class="co">#&gt; 28: CHERICHERILADY   3   100    0.167 1.7403264      5                  A</span>
<span class="co">#&gt; 29: CHERICHERILADY   3   100    5.000 1.6813097      3                  A</span>
<span class="co">#&gt; 30: CHERICHERILADY   3   100    5.000 2.0703185      5                  A</span>
<span class="co">#&gt; 31: CHERICHERILADY   3   100    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 32: CHERICHERILADY   3   100    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 33: CHERICHERILADY   3   100    0.167 1.4077223      3                  B</span>
<span class="co">#&gt; 34: CHERICHERILADY   3   100    0.167 1.4689478      5                  B</span>
<span class="co">#&gt; 35: CHERICHERILADY   3   100    5.000 2.5328115      3                  B</span>
<span class="co">#&gt; 36: CHERICHERILADY   3   100    5.000 2.1029809      5                  B</span>
<span class="co">#&gt; 37: CHERICHERILADY   4   100    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 38: CHERICHERILADY   4   100    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 39: CHERICHERILADY   4   100    0.167 0.9259389      3                  A</span>
<span class="co">#&gt; 40: CHERICHERILADY   4   100    0.167 1.4567690      5                  A</span>
<span class="co">#&gt; 41: CHERICHERILADY   4   100    5.000 2.1933157      3                  A</span>
<span class="co">#&gt; 42: CHERICHERILADY   4   100    5.000 2.2186362      5                  A</span>
<span class="co">#&gt; 43: CHERICHERILADY   4   100    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 44: CHERICHERILADY   4   100    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 45: CHERICHERILADY   4   100    0.167 1.1325609      3                  B</span>
<span class="co">#&gt; 46: CHERICHERILADY   4   100    0.167 1.4687089      5                  B</span>
<span class="co">#&gt; 47: CHERICHERILADY   4   100    5.000 2.2201589      3                  B</span>
<span class="co">#&gt; 48: CHERICHERILADY   4   100    5.000 2.6779419      5                  B</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [[3]][[1]]</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt;  1: CHERICHERILADY   1   200    0.000 0.0000000      3                  A</span>
<span class="co">#&gt;  2: CHERICHERILADY   1   200    0.000 0.0000000      5                  A</span>
<span class="co">#&gt;  3: CHERICHERILADY   1   200    0.167 0.9192103      3                  A</span>
<span class="co">#&gt;  4: CHERICHERILADY   1   200    0.167 1.3795445      5                  A</span>
<span class="co">#&gt;  5: CHERICHERILADY   1   200    5.000 1.6738519      3                  A</span>
<span class="co">#&gt;  6: CHERICHERILADY   1   200    5.000 2.0097934      5                  A</span>
<span class="co">#&gt;  7: CHERICHERILADY   1   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt;  8: CHERICHERILADY   1   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt;  9: CHERICHERILADY   1   200    0.167 1.3003182      3                  B</span>
<span class="co">#&gt; 10: CHERICHERILADY   1   200    0.167 1.6588773      5                  B</span>
<span class="co">#&gt; 11: CHERICHERILADY   1   200    5.000 1.8973142      3                  B</span>
<span class="co">#&gt; 12: CHERICHERILADY   1   200    5.000 1.9998967      5                  B</span>
<span class="co">#&gt; 13: CHERICHERILADY   2   200    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 14: CHERICHERILADY   2   200    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 15: CHERICHERILADY   2   200    0.167 1.5072892      3                  A</span>
<span class="co">#&gt; 16: CHERICHERILADY   2   200    0.167 1.3773792      5                  A</span>
<span class="co">#&gt; 17: CHERICHERILADY   2   200    5.000 2.0170342      3                  A</span>
<span class="co">#&gt; 18: CHERICHERILADY   2   200    5.000 1.9735832      5                  A</span>
<span class="co">#&gt; 19: CHERICHERILADY   2   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 20: CHERICHERILADY   2   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 21: CHERICHERILADY   2   200    0.167 1.2415880      3                  B</span>
<span class="co">#&gt; 22: CHERICHERILADY   2   200    0.167 0.8160180      5                  B</span>
<span class="co">#&gt; 23: CHERICHERILADY   2   200    5.000 1.9620370      3                  B</span>
<span class="co">#&gt; 24: CHERICHERILADY   2   200    5.000 1.5091585      5                  B</span>
<span class="co">#&gt; 25: CHERICHERILADY   3   200    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 26: CHERICHERILADY   3   200    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 27: CHERICHERILADY   3   200    0.167 1.1402270      3                  A</span>
<span class="co">#&gt; 28: CHERICHERILADY   3   200    0.167 1.3932776      5                  A</span>
<span class="co">#&gt; 29: CHERICHERILADY   3   200    5.000 1.8251330      3                  A</span>
<span class="co">#&gt; 30: CHERICHERILADY   3   200    5.000 2.2904576      5                  A</span>
<span class="co">#&gt; 31: CHERICHERILADY   3   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 32: CHERICHERILADY   3   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 33: CHERICHERILADY   3   200    0.167 1.4656616      3                  B</span>
<span class="co">#&gt; 34: CHERICHERILADY   3   200    0.167 1.1774973      5                  B</span>
<span class="co">#&gt; 35: CHERICHERILADY   3   200    5.000 2.0786363      3                  B</span>
<span class="co">#&gt; 36: CHERICHERILADY   3   200    5.000 1.6740664      5                  B</span>
<span class="co">#&gt; 37: CHERICHERILADY   4   200    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 38: CHERICHERILADY   4   200    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 39: CHERICHERILADY   4   200    0.167 0.7852231      3                  A</span>
<span class="co">#&gt; 40: CHERICHERILADY   4   200    0.167 1.5536717      5                  A</span>
<span class="co">#&gt; 41: CHERICHERILADY   4   200    5.000 1.4398432      3                  A</span>
<span class="co">#&gt; 42: CHERICHERILADY   4   200    5.000 2.0938878      5                  A</span>
<span class="co">#&gt; 43: CHERICHERILADY   4   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 44: CHERICHERILADY   4   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 45: CHERICHERILADY   4   200    0.167 1.1391676      3                  B</span>
<span class="co">#&gt; 46: CHERICHERILADY   4   200    0.167 0.9436166      5                  B</span>
<span class="co">#&gt; 47: CHERICHERILADY   4   200    5.000 1.9333818      3                  B</span>
<span class="co">#&gt; 48: CHERICHERILADY   4   200    5.000 1.9133177      5                  B</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]][[2]]</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span>
<span class="co">#&gt;  1: CHERICHERILADY   1   200    0.000 0.0000000      3                  A</span>
<span class="co">#&gt;  2: CHERICHERILADY   1   200    0.000 0.0000000      5                  A</span>
<span class="co">#&gt;  3: CHERICHERILADY   1   200    0.167 1.2889882      3                  A</span>
<span class="co">#&gt;  4: CHERICHERILADY   1   200    0.167 0.6497663      5                  A</span>
<span class="co">#&gt;  5: CHERICHERILADY   1   200    5.000 2.2352366      3                  A</span>
<span class="co">#&gt;  6: CHERICHERILADY   1   200    5.000 1.7340315      5                  A</span>
<span class="co">#&gt;  7: CHERICHERILADY   1   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt;  8: CHERICHERILADY   1   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt;  9: CHERICHERILADY   1   200    0.167 1.0475158      3                  B</span>
<span class="co">#&gt; 10: CHERICHERILADY   1   200    0.167 1.2707170      5                  B</span>
<span class="co">#&gt; 11: CHERICHERILADY   1   200    5.000 1.5745761      3                  B</span>
<span class="co">#&gt; 12: CHERICHERILADY   1   200    5.000 1.9409744      5                  B</span>
<span class="co">#&gt; 13: CHERICHERILADY   2   200    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 14: CHERICHERILADY   2   200    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 15: CHERICHERILADY   2   200    0.167 0.9468887      3                  A</span>
<span class="co">#&gt; 16: CHERICHERILADY   2   200    0.167 1.3770209      5                  A</span>
<span class="co">#&gt; 17: CHERICHERILADY   2   200    5.000 1.7767978      3                  A</span>
<span class="co">#&gt; 18: CHERICHERILADY   2   200    5.000 2.1329732      5                  A</span>
<span class="co">#&gt; 19: CHERICHERILADY   2   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 20: CHERICHERILADY   2   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 21: CHERICHERILADY   2   200    0.167 1.3397511      3                  B</span>
<span class="co">#&gt; 22: CHERICHERILADY   2   200    0.167 0.6677473      5                  B</span>
<span class="co">#&gt; 23: CHERICHERILADY   2   200    5.000 1.7203313      3                  B</span>
<span class="co">#&gt; 24: CHERICHERILADY   2   200    5.000 1.4457426      5                  B</span>
<span class="co">#&gt; 25: CHERICHERILADY   3   200    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 26: CHERICHERILADY   3   200    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 27: CHERICHERILADY   3   200    0.167 1.1518489      3                  A</span>
<span class="co">#&gt; 28: CHERICHERILADY   3   200    0.167 1.0544928      5                  A</span>
<span class="co">#&gt; 29: CHERICHERILADY   3   200    5.000 1.8950090      3                  A</span>
<span class="co">#&gt; 30: CHERICHERILADY   3   200    5.000 1.7786260      5                  A</span>
<span class="co">#&gt; 31: CHERICHERILADY   3   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 32: CHERICHERILADY   3   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 33: CHERICHERILADY   3   200    0.167 1.3907501      3                  B</span>
<span class="co">#&gt; 34: CHERICHERILADY   3   200    0.167 1.0546782      5                  B</span>
<span class="co">#&gt; 35: CHERICHERILADY   3   200    5.000 2.1036419      3                  B</span>
<span class="co">#&gt; 36: CHERICHERILADY   3   200    5.000 2.1847686      5                  B</span>
<span class="co">#&gt; 37: CHERICHERILADY   4   200    0.000 0.0000000      3                  A</span>
<span class="co">#&gt; 38: CHERICHERILADY   4   200    0.000 0.0000000      5                  A</span>
<span class="co">#&gt; 39: CHERICHERILADY   4   200    0.167 1.5362964      3                  A</span>
<span class="co">#&gt; 40: CHERICHERILADY   4   200    0.167 1.1456876      5                  A</span>
<span class="co">#&gt; 41: CHERICHERILADY   4   200    5.000 2.0304707      3                  A</span>
<span class="co">#&gt; 42: CHERICHERILADY   4   200    5.000 1.9172427      5                  A</span>
<span class="co">#&gt; 43: CHERICHERILADY   4   200    0.000 0.0000000      3                  B</span>
<span class="co">#&gt; 44: CHERICHERILADY   4   200    0.000 0.0000000      5                  B</span>
<span class="co">#&gt; 45: CHERICHERILADY   4   200    0.167 1.2819903      3                  B</span>
<span class="co">#&gt; 46: CHERICHERILADY   4   200    0.167 0.9935587      5                  B</span>
<span class="co">#&gt; 47: CHERICHERILADY   4   200    5.000 2.2534796      3                  B</span>
<span class="co">#&gt; 48: CHERICHERILADY   4   200    5.000 1.3380264      5                  B</span>
<span class="co">#&gt;           Sequence Rep State Exposure      Mass Charge Experimental_state</span></code></pre></div>
</div>
<div id="power-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#power-estimation" class="anchor"></a>Power estimation</h2>
<p>The package <code>powerHaDeX</code> provides a possibility of the estimation of rejection rate in pairwise testing of differences in deuteration levels.</p>
<p>The tests available in the package are:</p>
<ul>
<li><p><code>test_semiparametric</code> - Semiparametric test,</p></li>
<li><p><code>test_houde</code> - Damian Houde’s confidence intervals test (Houde, Berkowitz, and Engen 2011),</p></li>
<li><p><code>test_hdx_analyzer</code> - HDX-Analyzer model (Liu et al. 2011),</p></li>
<li><p><code>test_memhdx_model</code> - MEMHDX model (Hourdel et al. 2016).</p></li>
</ul>
<p>We can use the function <code>calculate_hdx_power</code> to execute the testing procedure on the data simulated by <code>get_noisy_deuteration_curves</code>. Example usage of the function is shown below</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_hdx_power.html">calculate_hdx_power</a></span><span class="op">(</span><span class="va">deuteration_curves_paired_states</span>,
                    tests <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">test_houde</span><span class="op">)</span>,
                    summarized <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt;          Sequence Num_replicates Num_states Num_timepoints  Test State_1</span>
<span class="co">#&gt; 1: CHERICHERILADY              4          2              3 Houde     100</span>
<span class="co">#&gt; 2: CHERICHERILADY              4          2              3 Houde     100</span>
<span class="co">#&gt; 3: CHERICHERILADY              4          2              3 Houde     100</span>
<span class="co">#&gt; 4: CHERICHERILADY              4          2              3 Houde     100</span>
<span class="co">#&gt; 5: CHERICHERILADY              4          2              3 Houde     200</span>
<span class="co">#&gt; 6: CHERICHERILADY              4          2              3 Houde     200</span>
<span class="co">#&gt;    State_2 Test_statistic P_value Significant_difference Time Transformation</span>
<span class="co">#&gt; 1:     200             NA      NA                  FALSE   NA             NA</span>
<span class="co">#&gt; 2:     200             NA      NA                  FALSE   NA             NA</span>
<span class="co">#&gt; 3:     100             NA      NA                  FALSE   NA             NA</span>
<span class="co">#&gt; 4:     100             NA      NA                  FALSE   NA             NA</span>
<span class="co">#&gt; 5:     200             NA      NA                  FALSE   NA             NA</span>
<span class="co">#&gt; 6:     200             NA      NA                  FALSE   NA             NA</span>
<span class="co">#&gt;    AIC logLik</span>
<span class="co">#&gt; 1:  NA     NA</span>
<span class="co">#&gt; 2:  NA     NA</span>
<span class="co">#&gt; 3:  NA     NA</span>
<span class="co">#&gt; 4:  NA     NA</span>
<span class="co">#&gt; 5:  NA     NA</span>
<span class="co">#&gt; 6:  NA     NA</span></code></pre></div>
<p>The summarized result is following</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_hdx_power.html">calculate_hdx_power</a></span><span class="op">(</span><span class="va">deuteration_curves_paired_states</span>,
                    tests <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">test_houde</span><span class="op">)</span>,
                    summarized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;          Sequence Num_replicates Num_states Num_timepoints  Test Transformation</span>
<span class="co">#&gt; 1: CHERICHERILADY              4          2              3 Houde             NA</span>
<span class="co">#&gt; 2: CHERICHERILADY              4          2              3 Houde             NA</span>
<span class="co">#&gt; 3: CHERICHERILADY              4          2              3 Houde             NA</span>
<span class="co">#&gt;    Time State_1 State_2 Power</span>
<span class="co">#&gt; 1:   NA     100     200     0</span>
<span class="co">#&gt; 2:   NA     100     100     0</span>
<span class="co">#&gt; 3:   NA     200     200     0</span></code></pre></div>
<p>There is a possibility of simulate the rejection rate of another test using an external implementation. Such a test function for pairwise testing should be of specific shape as below:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>example_test &lt;-<span class="st"> </span><span class="cf">function</span>(data, significance_level) {</span>
<span id="cb15-2"><a href="#cb15-2"></a>  States =<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>State)</span>
<span id="cb15-3"><a href="#cb15-3"></a>  </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="co"># testing procedure here</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  </span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="kw">return</span>(data.table<span class="op">::</span><span class="kw">data.table</span>(<span class="dt">Test =</span> <span class="st">"Example test"</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>                                <span class="dt">State_1 =</span> States[<span class="dv">1</span>],</span>
<span id="cb15-8"><a href="#cb15-8"></a>                                <span class="dt">State_2 =</span> States[<span class="dv">2</span>],</span>
<span id="cb15-9"><a href="#cb15-9"></a>                                <span class="dt">Test_statistic =</span> <span class="ot">NA</span>,</span>
<span id="cb15-10"><a href="#cb15-10"></a>                                <span class="dt">P_value =</span> <span class="ot">NA</span>,</span>
<span id="cb15-11"><a href="#cb15-11"></a>                                <span class="dt">Significant_difference =</span> <span class="co">#TRUE or FALSE,</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>                                  <span class="dt">Time =</span> <span class="ot">NA</span>,</span>
<span id="cb15-13"><a href="#cb15-13"></a>                                <span class="dt">Transformation =</span> <span class="ot">NA</span>,</span>
<span id="cb15-14"><a href="#cb15-14"></a>                                <span class="dt">AIC =</span> <span class="ot">NA</span>,</span>
<span id="cb15-15"><a href="#cb15-15"></a>                                <span class="dt">logLik =</span> <span class="ot">NA</span>))</span>
<span id="cb15-16"><a href="#cb15-16"></a>}</span></code></pre></div>
<p>where the parameter <code>data</code> is one experiment, that is one data table obtained from the function <code>get_noisy_deuteration_curves</code>. In order to add such a test to the simulation, we should set <code>tests = list(houde, example_test)</code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Krystyna Grzesiak.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
